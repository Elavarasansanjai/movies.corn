<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Movie Search Website</title>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
    />
    <!-- font awesome icons cdn -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
      integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&display=swap");
      :root {
        --md-dark-color: #1d1d1d;
        --dark-color: #171717;
        --light-dark-color: #292929;
        --yellow-color: #d4aa11;
      }
      * {
        padding: 0;
        margin: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", sans-serif;
        background-color: var(--dark-color);
        color: #fff;
      }
      .nav {
        background-color: var(--md-dark-color);
        padding-top: 20px;
        padding-bottom: 20px;
        padding-left: 10%;
      }
      .user-inp {
        display: flex;
        align-items: center;
        height: 130px;
        background-color: var(--light-dark-color);
        justify-content: center;
      }
      .con2 {
        margin-top: 20px;
        width: 100%;
        justify-content: center;
        background-color: #3f3d3d;
      }
      .searchbox {
        font-weight: bold;
        color: #fff;
      }

      .user-inp p {
        font-weight: bold;
        margin-right: 20px;
      }
      .hide {
        display: none;
      }
      .yello {
        color: #fdfd45;
      }
      .fa-solid {
        color: rgb(27, 27, 27);
      }
      .movie-name {
        border: 2px solid #fdfd45;
        margin-left: 20px;
        padding: 10px;
        height: 40px;
        background-color: var(--light-dark-color);
        outline: none;
        color: white;
        width: 250px;
        border-radius: 2px 0 0 2px;
      }
      .movie-name :focus {
        color: #fff;
        box-shadow: 0 0 5px #cccc3e;
      }
      .user-inp-container {
        display: flex;
        align-items: center;
        position: relative;
        justify-content: center;
        height: 110px;
        background-color: var(--light-dark-color);
      }
      ::-webkit-progress-bar {
        color: #cccc3e;
      }
      .inp-container {
        position: absolute;

        top: 70%;
        transform: translateX(65px);
        max-height: 400px;

        width: 280px;
        overflow-y: scroll;
      }

      .submit-search {
        height: 40px;
        border: 2px solid #fdfd45;
        border-left: none;

        padding-left: 10px;
        padding-right: 10px;
        background-color: #fdfd45;
        color: rgb(20, 20, 20);
        border-radius: 0 2px 2px 0;
      }

      .m-title {
        margin-top: 20px;
        margin-bottom: 20px;
        color: #fdfd45;
        font-family: Arial, Helvetica, sans-serif;
      }
      .con1 {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-left: 30px;
        margin-top: 30px;
        margin-bottom: 30px;
      }
      .content {
        justify-content: space-around;
      }
      .img {
        margin-top: 25px;
        width: 250px;
        height: 340px;
        border: 2px solid #fff;
        margin-left: 40px;
      }
      .m-his {
        width: 450px;
        margin-left: 90px;
      }
      .m-his p {
        margin-top: 10px;
        margin-bottom: 10px;
      }
      .side {
        font-size: 19px;
        color: rgb(255, 255, 255);
      }
      .language {
        font-size: 19px;
        color: #fdfd45;
      }
      .languages {
        font-size: 15px;
        color: #cccc3e;
      }
      .res {
        font-size: 15px;
        color: rgb(234, 237, 240);
      }
      .con2 a {
        text-decoration: none;
      }
      ::-webkit-scrollbar {
        width: 12px;
      }
      ::-webkit-scrollbar-thumb {
        background: linear-gradient(transparent, #fdfd45);
      }

      .sugesion {
        display: flex;
        align-items: center;

        width: 100%;
        position: relative;
        text-decoration: none;
        color: white;
        background-color: rgb(46, 44, 44);
        margin-bottom: 5px;
        border-radius: 5px;
      }
      /* .sugesion:before {
              content: "";
              position: absolute;
              top: -2px;
              left: -2px;
              background: linear-gradient(
                45deg,
                #fb0094,
                #0000ff,
                #00ff00,
                #ffff00,
                #ff0000,
                #fb0094,
                #0000ff,
                #00ff00,
                #ffff00,
                #ff0000
              );
              background-size: 400%;
              width: calc(100% + 4px);
              height: calc(100% + 4px);

              z-index: -1;
              animation: animate 20s linear infinite;
            } */
      @keyframes animate {
        0% {
          background-position: 0 0;
        }
        50% {
          background-position: 300% 0;
        }
        100% {
          background-position: 0 0;
        }
      }

      .sug-his {
        margin-left: 20px;

        padding-bottom: 10px;
      }
      .sug-his p {
        margin-left: 20px;
        margin-top: 10px;
      }
      .tittle {
        margin-left: 13px;
        font-family: Arial, Helvetica, sans-serif;
      }
      .rating {
        background-color: #d4aa11;
        padding: 5px;
        border-radius: 6px;
        color: #fff;
      }
      .tittle {
        text-decoration: none;
      }
      .year-movie {
        text-decoration: none;
      }
      .movies-links {
        text-decoration: none;
      }
      .user-fun {
        margin-bottom: 20px;
      }
      .spiner {
        justify-content: center;
        text-align: center;
      }
      .spiner-img {
        height: 50px;
        width: 50px;
        animation: rotate 2s infinite linear;
      }
      @keyframes rotate {
        0% {
          transform: rotate(0);
        }
        100% {
          transform: rotate(360deg);
        }
      }
      ::-webkit-input-placeholder {
        color: white;
      }
      :focus::-webkit-input-placeholder {
        opacity: 0.6;
      }

      @media only screen and (max-width: 550px) {
        .nav {
          padding-left: 30px;
          position: relative;
          display: block;
        }
        .img {
          margin-left: 0;
        }
        .searchbox {
          display: none;
        }
        .user-inp {
          position: absolute;
          top: 15vh;
          right: 50%;
          left: 50%;
          text-align: center;
          justify-content: center;
          margin: auto 0;
        }
        .inp-container {
          position: absolute;

          top: 70%;
          transform: translateX(8px);
          max-height: 400px;

          width: 300px;
          overflow-y: scroll;
          overflow-x: hidden;
        }

        .content {
          margin-top: 1px;
          flex-wrap: wrap;
        }
        .user-inp p {
          display: none;
        }
        ::-webkit-input-placeholder {
          color: white;
        }
        :focus::-webkit-input-placeholder {
          opacity: 0.6;
        }

        .con1 {
          padding: 10px;
          width: 100%;
          margin-top: 20px;
          margin-right: 20px;
          margin-left: 20px;
          display: inline;
          justify-content: start;
        }
        .m-title {
          font-size: 23px;
        }
        .con2 {
          justify-content: center;
          margin-right: 20px;
          width: 100%;
        }

        .sug-his p {
          margin-left: 20px;

          margin-top: 10px;
          text-decoration: none;
        }
        .spiner-img {
          height: 50px;
          width: 50px;
          animation: rotate 2s infinite linear;
        }
        .movie-img {
          justify-content: center;
          align-items: center;
          display: flex;
        }
        .m-his {
          padding-top: 10;
          margin-top: 20px;
          margin-left: 40px;
          width: 80%;
        }
        .movie-name {
          margin-left: 0;
        }
        @keyframes rotate {
          0% {
            transform: rotate(0);
          }
          100% {
            transform: rotate(360deg);
          }
        }
      }
    </style>
  </head>
  <body>
    <nav class="nav">
      <h1>Movi <span class="yello">Corn.</span></h1>
    </nav>
    <!-- <header class="user-inp">
      <p>Search Movie :</p>
      <div class="user-inp">
        <input
          type="text"
          placeholder="search movies here..."
          class="movie-name"
        />
        <button type="submit" class="submit-search">
          <i class="fa-solid fa-magnifying-glass"></i>
        </button>
        <div class="con2">
          <a href="#">
            <div class="sugesion">
              <div class="sug-img">
                <img src="./download.jfif" height="60" width="60" alt="" />
              </div>
              <div class="sug-his">
                <h3 class="tittle">avatar</h3>
                <p class="year-movie">2003</p>
              </div>
            </div>
          </a>
        </div>
      </div>
    </header> -->
    <header class="user-inp-container">
      <p class="searchbox">Search Movie :</p>
      <input
        type="text"
        class="movie-name"
        onkeyup="findmovies()"
        onclick="findmovies()"
        placeholder="search movies here"
      />
      <button type="submit" class="submit-search">
        <i class="fa-solid fa-magnifying-glass"></i>
      </button>
      <div class="inp-container">
        <div class="con2">
          <!-- <a href="#">
            <div class="sugesion">
              <div class="sug-img">
                <img src="./download.jfif" height="60" width="60" alt="" />
              </div>
              <div class="sug-his">
                <h3 class="tittle">avatar</h3>
                <p class="year-movie">2003</p>
              </div>
            </div>
          </a> -->
        </div>
      </div>
    </header>

    <div class="content">
      <div class="con1">
        <!-- <div class="user-fun"> -->
        <!-- <p>üòÉ start by searching for a movies! Have fun!</p> -->
        <!-- </div> -->
        <!-- spinner -->
        <!-- <div class="spiner">
          <img
            src="./spiner-image-removebg-preview.png"
            alt=""
            class="spiner-img"
          />
        </div> -->
        <!-- <div class="movie-img">
          <img src="./download.jfif" alt="" class="img" />
        </div>
        <div class="m-his">
          <h1 class="m-title">Avatar</h1>
          <p>
            Year: <span class="year">2009</span>
            <span class="rating">Ratings: PG-13</span> Released:
            <span class="m-relese">15 Dec 2009</span>
          </p>
          <p class="side">
            <strong> Genre:</strong>
            <span class="gener res">Action,AAdventure,Fantasy</span>
          </p>
          <p class="side">
            <strong>Writer:</strong>
            <span class="writer res">Jamas Camern</span>
          </p>
          <p class="side">
            <strong>Actors:</strong>
            <span class="actors res">Sam Worthington</span>
          </p>
          <p class="side">
            <strong> Plot:</strong>
            <span class="plot res">
              Lorem, ipsum dolor sit amet consectetur adipisicing elit. Sit
              corporis consectetur eveniet harum quasi recusandae eaque aperiam,
              alias eius officiis.
            </span>
          </p>
          <p class="language">
            <strong> Language:</strong>
            <span class="languages">English,Spain</span>
          </p>
          <p>
            won <span class="oscar">3</span> Oscars. 89 Wins & 131 nomination
            total
          </p>
        </div> -->
      </div>
    </div>
    <script>
      //https://omdbapi.com/?s=vikram&page=1&apikey=c33d203e
      //https://omdbapi.com/?s=${moviename}&page=1&apikey=fc1fef96
      //http://www.omdbapi.com/?i=tt0944947&apikey=fc1fef96
      const movieContainer = document.querySelector(".con2");
      const timeout = function (s) {
        return new Promise(function (_, reject) {
          setTimeout(() => {
            reject(
              new Error(`Request took too long! Timeout after ${s} second üòÉ`)
            );
          }, s * 1000);
        });
      };
      const spiner = (parenEl) => {
        let markup = `
                <div class="spiner">
                      <img
                        src="./spiner-image-removebg-preview.png"
                        alt=""
                        class="spiner-img"
                      />
                </div>
                `;
        parenEl.innerHTML = "";
        parenEl.insertAdjacentHTML("afterbegin", markup);
      };
      const result_movies_container = document.querySelector(".con2");
      const movies_container = document.querySelector(".con1");
      const showMovie = async function () {
        try {
          //movie id
          const id = window.location.hash.slice(1);
          console.log(id);
          if (!id) return;
          console.log(id);
          //spinner
          spiner(movies_container);

          // loading movie
          const res = await fetch(
            `http://www.omdbapi.com/?i=${id}&apikey=fc1fef96`
          );
          const data = await res.json();
          if (!res.ok) throw new Error(`${res.status}`);
          console.log(res, data);

          let movie = {
            Actors: data.Actors,
            Awards: data.Awards,
            Country: data.Country,
            Director: data.Director,
            Genre: data.Genre,
            Language: data.Language,
            Plot: data.Plot,
            Poster: data.Poster,
            Rated: data.Rated,
            Released: data.Released,
            Title: data.Title,
            Type: data.Type,
            Year: data.Year,
            imdbId: data.imdbId,
            Writer: data.Writer,
          };
          console.log(movie);
          //rendering movie
          const markup = `
                    <div class="movie-img">
                      <img src="${movie.Poster}" alt="" class="img" />
                    </div>
                    <div class="m-his">
                      <h3 class="m-title">${movie.Title}</h3>
                      <p>
                        Year: <span class="year">${movie.Year}</span>
                        <span class="rating">Ratings:${movie.Rated}</span> Released:
                        <span class="m-relese">${movie.Released}</span>
                      </p>
                      <p class="side">
                        <strong> Genre:</strong>
                        <span class="gener res">${movie.Genre}</span>
                      </p>
                      <p class="side">
                        <strong>Writer:</strong>
                        <span class="writer res">${movie.Writer}</span>
                      </p>
                      <p class="side">
                        <strong>Actors:</strong>
                        <span class="actors res">${movie.Actors}</span>
                      </p>
                      <p class="side">
                        <strong> Plot:</strong>
                        <span class="plot res">
                        ${movie.Plot}
                        </span>
                      </p>
                      <p class="language">
                        <strong> Language:</strong>
                        <span class="languages">${movie.Language}</span>
                      </p>
                      <p>
                      üèÜü•á${movie.Awards}
                      </p>
                    </div>
                `;
          movies_container.innerHTML = "";
          movies_container.insertAdjacentHTML("afterbegin", markup);
        } catch (err) {
          alert(err);
        }
      };

      const sugetionmovies = async function (moviename) {
        try {
          spiner(movieContainer);

          const res = await fetch(
            `https://omdbapi.com/?s=${moviename}&page=1&apikey=fc1fef96`
          );
          const data = await res.json();
          console.log(res);
          // await timeout(10);
          console.log(data.Response);
          if (!(data.Response === "True"))
            throw new Error(`${moviename} ${data.Error} üòÉ`);
          console.log(data);

          let movies = data.Search;
          movieContainer.innerHTML = "";
          movies.forEach((mov) => {
            let markup = `
                  <a href="#${mov.imdbID}" class="movies-links">
                    <div class="sugesion">
                      <div class="">
                        <img src="${mov.Poster}" height="60" width="60" alt="" />
                      </div>
                      <div class="sug-his">
                        <p class="tittle">${mov.Title}</p>
                        <p class="year-movie">${mov.Year}</p>
                      </div>
                    </div>
                  </a> 
                  `;

            movieContainer.insertAdjacentHTML("beforeend", markup);
          });
        } catch (err) {
          // movieContainer.innerHTML = "";
          // movieContainer.style.padding = "20px";
          // movieContainer.innerHTML = err.message;
          console.log(err);
        }
      };
      //sugetionmovies("vikram");

      const userSearch = document.querySelector(".submit-search");

      userSearch.addEventListener("click", () => {
        const usersearchValue = document.querySelector(".movie-name").value;
        if (!usersearchValue) return;
        sugetionmovies(usersearchValue);
        document.querySelector(".movie-name").value = "";
      });
      document.querySelectorAll(".con2").forEach((mov) => {
        mov.addEventListener("click", () => {
          console.log("click");
          movieContainer.classList.add("hide");

          document.querySelector(".movie-name").value = "";
        });
      });
      window.addEventListener("hashchange", showMovie);
      const findmovies = () => {
        const usersearchValue = document
          .querySelector(".movie-name")
          .value.trim();
        console.log(usersearchValue);
        sugetionmovies(usersearchValue);
        movieContainer.classList.remove("hide");
        if (usersearchValue === "") movieContainer.classList.add("hide");
      };
      document.querySelector(".content").addEventListener("click", () => {
        movieContainer.classList.add("hide");
      });
    </script>
  </body>
</html>
